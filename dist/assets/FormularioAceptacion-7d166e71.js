import{r,j as e,f as p,L as u,A as v,a as g,b as j,d as _,B as w,g as A}from"./index-a97f1121.js";const k=({sessionId:b,onStepComplete:x,onProgressUpdate:n})=>{const[a,N]=r.useState({consentimiento_datos:!1,declaracion_veracidad:!1,declaracion_origen_fondos:!1}),[f,h]=r.useState(!1),[o,c]=r.useState(""),[d,l]=r.useState("");r.useEffect(()=>{typeof n=="function"&&n({currentQuestion:1,totalQuestions:3})},[n]);const m=i=>s=>{N(t=>({...t,[i]:s.target.checked})),d&&l(""),o&&c("")},y=()=>{const{consentimiento_datos:i,declaracion_veracidad:s,declaracion_origen_fondos:t}=a;return!i||!s||!t?(l("Debe aceptar las 3 declaraciones para continuar."),!1):(l(""),!0)},S=async i=>{if(i.preventDefault(),!!y()){h(!0),c("");try{const s=await fetch("/api/orchestrator",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"submit_form_step",sessionId:b,payload:{currentStep:5,stepData:{consentimiento_datos:a.consentimiento_datos,declaracion_veracidad:a.declaracion_veracidad,declaracion_origen_fondos:a.declaracion_origen_fondos}}})});if(!s.ok)throw new Error(`Error del servidor: ${s.status}`);const t=await s.json();console.log("Respuesta del orquestador:",t),x&&x(5)}catch(s){console.error("Error al enviar declaraciones:",s),c("Error al enviar la información. Por favor, inténtelo de nuevo.")}finally{h(!1)}}};return e.jsx("div",{className:"max-w-3xl mx-auto p-3 sm:p-4",children:e.jsxs("div",{className:"mt-12",children:[e.jsx("h1",{className:"text-3xl sm:text-4xl font-bold tracking-tight text-foreground text-center",children:"Paso 5: Declaraciones y Aceptación"}),e.jsx("p",{className:"text-muted-foreground text-center mt-6",children:"Para completar su solicitud, debe leer y aceptar las siguientes declaraciones y términos de servicio."}),e.jsx(p,{className:"my-8"}),e.jsxs("form",{onSubmit:S,className:"mt-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{id:"consentimiento_datos",type:"checkbox",checked:a.consentimiento_datos,onChange:m("consentimiento_datos"),className:"mt-0.5 h-4 w-4 rounded border-input text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring"}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"consentimiento_datos",className:"text-sm font-medium",children:"Consentimiento de tratamiento de datos personales."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Autorizo el tratamiento de mis datos según la política de privacidad."})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{id:"declaracion_veracidad",type:"checkbox",checked:a.declaracion_veracidad,onChange:m("declaracion_veracidad"),className:"mt-0.5 h-4 w-4 rounded border-input text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring"}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"declaracion_veracidad",className:"text-sm font-medium",children:"Declaración de veracidad de la información."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Confirmo que la información suministrada es veraz y completa."})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{id:"declaracion_origen_fondos",type:"checkbox",checked:a.declaracion_origen_fondos,onChange:m("declaracion_origen_fondos"),className:"mt-0.5 h-4 w-4 rounded border-input text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring"}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"declaracion_origen_fondos",className:"text-sm font-medium",children:"Declaración sobre el origen de los fondos."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Afirmo que los fondos provienen de actividades lícitas y verificables."})]})]}),d&&e.jsxs(v,{className:"mb-6",children:[e.jsx(g,{className:"h-4 w-4"}),e.jsx(j,{children:"Aviso"}),e.jsx(_,{children:d})]}),o&&e.jsxs(v,{variant:"destructive",className:"mb-6",children:[e.jsx(g,{className:"h-4 w-4"}),e.jsx(j,{children:"Error"}),e.jsx(_,{children:o})]}),e.jsx(p,{className:"my-8"}),e.jsxs("div",{className:"text-center mt-12",children:[e.jsx(w,{type:"submit",size:"lg",disabled:f||!(a.consentimiento_datos&&a.declaracion_veracidad&&a.declaracion_origen_fondos),className:"min-w-[250px]",children:f?e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"mr-2 w-5 h-5"}),"Finalizando Solicitud..."]}):"Finalizar Solicitud de Crédito"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-6",children:'Al hacer clic en "Finalizar", su solicitud será enviada para evaluación.'})]})]})]})})};export{k as default};
