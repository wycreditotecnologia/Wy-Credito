import{c as o,j as e,r as i,g as w,A as p,a as C,b as f,d as N,N as k,O as u,f as V,B as H}from"./index-a97f1121.js";import{B as $}from"./Business-7bdb93f4.js";const A=o(e.jsx("path",{d:"M4 10h3v7H4zm6.5 0h3v7h-3zM2 19h20v3H2zm15-9h3v7h-3zm-5-9L2 6v2h20V6z"})),B=o(e.jsx("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm2 16H8v-2h8zm0-4H8v-2h8zm-3-5V3.5L18.5 9z"})),F=o(e.jsx("path",{d:"m5.2494 8.0688 2.83-2.8269 14.1343 14.15-2.83 2.8269zm4.2363-4.2415 2.828-2.8289 5.6577 5.656-2.828 2.8289zM.9989 12.3147l2.8284-2.8285 5.6569 5.6569-2.8285 2.8284zM1 21h12v2H1z"})),T=o(e.jsx("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5s-3 1.34-3 3 1.34 3 3 3m-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5 5 6.34 5 8s1.34 3 3 3m0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5m8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5"})),L=o(e.jsx("path",{d:"M12 1 3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11z"})),q=o(e.jsx("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"})),K=({sessionId:x,onStepComplete:g})=>{var z;const[b,E]=i.useState(null),[I,P]=i.useState(!0),[v,y]=i.useState(!1),[_,m]=i.useState(""),[l,D]=i.useState(""),d=t=>{const n=Number(t);return Number.isFinite(n)?`$ ${n.toLocaleString("es-CO",{maximumFractionDigits:0})}`:"N/A"},r=t=>t==null?!1:typeof t=="number"?Number.isFinite(t)&&t>0:String(t).trim().length>0,c=({filled:t})=>e.jsx(u,{variant:"secondary",className:`${t?"bg-green-600 text-white":"bg-red-600 text-white"} ml-2`,children:t?"Completado":"Pendiente"}),S=t=>["monto_solicitado","plazo_solicitado","destino_credito","ingresos_mensuales","egresos_mensuales","patrimonio"].every(O=>r(t==null?void 0:t[O]));i.useEffect(()=>{M()},[x]);const M=async()=>{try{const n=await(await fetch("/api/orchestrator",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"get_summary_data",sessionId:x})})).json();n.success?E(n.data):m(n.error||"Error al cargar los datos del resumen")}catch{m("Error de conexión al cargar el resumen")}finally{P(!1)}},R=async()=>{y(!0),m("");try{const n=await(await fetch("/api/orchestrator",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"complete_submission",sessionId:x})})).json();if(n.success){D(`¡Solicitud enviada exitosamente! Código de seguimiento: ${n.trackingCode}`);try{n.trackingCode&&localStorage.setItem(`tracking_code_${x}`,String(n.trackingCode))}catch{}g&&g()}else m(n.error||"Error al enviar la solicitud")}catch{m("Error de conexión al enviar la solicitud")}finally{y(!1)}};if(I)return e.jsxs("div",{className:"flex justify-center items-center min-h-[400px]",children:[e.jsx(w,{className:"w-14 h-14"}),e.jsx("p",{className:"ml-2 text-lg font-semibold",children:"Cargando resumen..."})]});if(!b)return e.jsxs(p,{variant:"destructive",children:[e.jsx(C,{className:"h-4 w-4"}),e.jsx(f,{children:"Error"}),e.jsx(N,{children:"No se pudieron cargar los datos del resumen. Por favor, intente nuevamente."})]});const{solicitud:s,empresa:a,documentos:h,garantia:j}=b;return e.jsxs("div",{className:"max-w-[800px] mx-auto p-3",children:[e.jsx("h1",{className:"text-3xl sm:text-4xl font-bold tracking-tight text-primary text-center mb-6",children:"Resumen de su Solicitud de Crédito"}),e.jsx("p",{className:"mb-6 text-center text-muted-foreground",children:"Revise cuidadosamente toda la información antes de enviar su solicitud."}),_&&e.jsxs(p,{variant:"destructive",className:"mb-6",children:[e.jsx(C,{className:"h-4 w-4"}),e.jsx(f,{children:"Error"}),e.jsx(N,{children:_})]}),l&&e.jsxs(p,{className:"mb-6",children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx(f,{children:"Éxito"}),e.jsx(N,{children:l})]}),e.jsxs("div",{className:"mt-12",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(A,{sx:{mr:4,color:"primary.main"}}),e.jsx("h3",{className:"text-xl font-semibold border-b pb-2 mb-6",children:"Información de la Solicitud"})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-2",children:[e.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Monto Solicitado:"}),e.jsx("p",{className:"text-lg font-semibold",children:d(s==null?void 0:s.monto_solicitado)})]}),e.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Plazo:"}),e.jsxs("p",{className:"text-lg font-semibold",children:[(s==null?void 0:s.plazo_meses)??(s==null?void 0:s.plazo_solicitado)??"N/A"," meses"]})]}),e.jsxs("div",{className:"col-span-12",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Propósito:"}),e.jsx("p",{className:"text-base",children:(s==null?void 0:s.proposito)||(s==null?void 0:s.destino_credito)||"N/A"})]})]})]}),e.jsxs("div",{className:"mt-12",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(A,{sx:{mr:4,color:"primary.main"}}),e.jsx("h3",{className:"text-xl font-semibold border-b pb-2 mb-6",children:"Información Financiera"})]}),e.jsx(u,{variant:"secondary",className:`${S(s)?"bg-green-600 text-white":"bg-yellow-500 text-white"} ml-2`,children:S(s)?"Sección completa":"Campos pendientes"})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-2",children:[e.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center justify-between",title:r(s==null?void 0:s.monto_solicitado)?void 0:"Ingresa el monto solicitado en COP.",children:[e.jsx("span",{children:"Monto Solicitado"}),e.jsx(c,{filled:r(s==null?void 0:s.monto_solicitado)})]}),e.jsx("p",{className:"text-lg font-semibold",children:d(s==null?void 0:s.monto_solicitado)})]}),e.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center justify-between",title:r(s==null?void 0:s.plazo_solicitado)?void 0:"Indica el plazo solicitado en meses.",children:[e.jsx("span",{children:"Plazo Solicitado"}),e.jsx(c,{filled:r(s==null?void 0:s.plazo_solicitado)})]}),e.jsxs("p",{className:"text-lg font-semibold",children:[(s==null?void 0:s.plazo_solicitado)??"N/A"," meses"]})]}),e.jsxs("div",{className:"col-span-12",children:[e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center justify-between",title:r(s==null?void 0:s.destino_credito)?void 0:"Describe el destino o propósito del crédito.",children:[e.jsx("span",{children:"Destino del Crédito"}),e.jsx(c,{filled:r(s==null?void 0:s.destino_credito)})]}),e.jsx("p",{className:"text-base",children:(s==null?void 0:s.destino_credito)||"N/A"})]}),e.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center justify-between",title:r(s==null?void 0:s.ingresos_mensuales)?void 0:"Registra tus ingresos mensuales en COP.",children:[e.jsx("span",{children:"Ingresos Mensuales"}),e.jsx(c,{filled:r(s==null?void 0:s.ingresos_mensuales)})]}),e.jsx("p",{className:"text-lg font-semibold",children:d(s==null?void 0:s.ingresos_mensuales)})]}),e.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center justify-between",title:r(s==null?void 0:s.egresos_mensuales)?void 0:"Registra tus egresos mensuales en COP.",children:[e.jsx("span",{children:"Egresos Mensuales"}),e.jsx(c,{filled:r(s==null?void 0:s.egresos_mensuales)})]}),e.jsx("p",{className:"text-lg font-semibold",children:d(s==null?void 0:s.egresos_mensuales)})]}),e.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center justify-between",title:r(s==null?void 0:s.patrimonio)?void 0:"Ingresa tu patrimonio estimado en COP.",children:[e.jsx("span",{children:"Patrimonio"}),e.jsx(c,{filled:r(s==null?void 0:s.patrimonio)})]}),e.jsx("p",{className:"text-lg font-semibold",children:d(s==null?void 0:s.patrimonio)})]})]})]}),e.jsxs("div",{className:"mt-12",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx($,{sx:{mr:4,color:"primary.main"}}),e.jsx("h3",{className:"text-xl font-semibold border-b pb-2 mb-6",children:"Información de la Empresa"})]}),e.jsxs("ul",{className:"space-y-2",children:[e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Razón Social"}),e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.razon_social)||"N/A"})]}),e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"NIT"}),e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.nit)||"N/A"})]}),e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Sector Económico"}),e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.sector_economico)||"N/A"})]}),e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Años de Funcionamiento"}),e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.anos_funcionamiento)||"N/A"})]}),e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Número de Empleados"}),e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.numero_empleados)||"N/A"})]})]})]}),e.jsxs("div",{className:"mt-12",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{sx:{mr:4,color:"primary.main"}}),e.jsx("h3",{className:"text-xl font-semibold border-b pb-2 mb-6",children:"Documentos Cargados"})]}),h&&h.length>0?e.jsx("div",{className:"grid grid-cols-12 gap-2",children:h.map((t,n)=>e.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:t.tipo_documento||"Documento"}),e.jsx(u,{variant:"secondary",className:"mt-1",children:t.nombre_archivo||t.tipo_documento||"Archivo subido"})]},n))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No hay documentos cargados"})]}),((a==null?void 0:a.nombre_referencia_1)||(a==null?void 0:a.nombre_referencia_2))&&e.jsxs("div",{className:"mt-12",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(T,{sx:{mr:4,color:"primary.main"}}),e.jsx("h3",{className:"text-xl font-semibold border-b pb-2 mb-6",children:"Referencias Comerciales"})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-2",children:[(a==null?void 0:a.nombre_referencia_1)&&e.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Referencia 1:"}),e.jsx("p",{className:"text-base",children:a.nombre_referencia_1}),e.jsx("p",{className:"text-sm",children:a.telefono_referencia_1})]}),(a==null?void 0:a.nombre_referencia_2)&&e.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Referencia 2:"}),e.jsx("p",{className:"text-base",children:a.nombre_referencia_2}),e.jsx("p",{className:"text-sm",children:a.telefono_referencia_2})]})]})]}),j&&e.jsxs("div",{className:"mt-12",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(L,{sx:{mr:4,color:"primary.main"}}),e.jsx("h3",{className:"text-xl font-semibold border-b pb-2 mb-6",children:"Garantía Mobiliaria"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Descripción:"}),e.jsx("p",{className:"text-base mb-6",children:j.descripcion}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Valor Estimado:"}),e.jsxs("p",{className:"text-lg font-semibold",children:["$",((z=j.valor_estimado)==null?void 0:z.toLocaleString())||"N/A"]})]}),e.jsxs("div",{className:"mt-12",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(F,{sx:{mr:4,color:"primary.main"}}),e.jsx("h3",{className:"text-xl font-semibold border-b pb-2 mb-6",children:"Declaraciones Aceptadas"})]}),e.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[e.jsx("li",{children:"✓ Acepto que el crédito será destinado únicamente para fines productivos"}),e.jsx("li",{children:"✓ Declaro que el crédito no será utilizado para gastos personales"}),e.jsx("li",{children:"✓ Autorizo el tratamiento de mis datos personales según la política de habeas data"})]})]}),e.jsx(V,{className:"my-8"}),e.jsx("div",{className:"flex justify-center",children:e.jsx(H,{onClick:R,size:"lg",disabled:v||l,className:`min-w-[300px] py-2 text-lg font-bold ${l?"bg-green-600 text-white hover:bg-green-600/90":""}`,children:v?e.jsxs("span",{className:"inline-flex items-center",children:[e.jsx(w,{className:"mr-2 w-5 h-5"}),"Enviando Solicitud..."]}):l?"Solicitud Enviada":e.jsxs("span",{className:"inline-flex items-center",children:[e.jsx(q,{className:"mr-2"}),"Confirmar y Enviar Solicitud"]})})}),l&&e.jsx("p",{className:"text-sm text-center mt-6 text-muted-foreground",children:"Recibirá un correo de confirmación con los detalles de su solicitud."})]})};export{K as default};
